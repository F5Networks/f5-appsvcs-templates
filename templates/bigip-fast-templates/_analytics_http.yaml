title: Analytics
contentType: application/json
bigipHideTemplate: true
bigipDependencies:
  - avr
definitions:
  enable_analytics:
    title: Analytics
    description: Use Analytics
    type: boolean
    default: false
  make_analytics_profile:
    title: FAST-Generated Analytics Profiles
    description: Uncheck to use an existing BIG-IP Analytics profile.
    type: boolean
    default: true
  analytics_existing_http_profile:
    title: HTTP Analytics Profile
    description: Select an existing HTTP Analytics profile.
    type: string
    enumFromBigip: ltm/profile/analytics
    default: '/Common/analytics'
template: |
  {
    "{{tenant_name}}": {
      "{{app_name}}": {
        {{#enable_analytics}}
          {{#make_analytics_profile}}
            "{{app_name}}_analytics": {
              "class": "Analytics_Profile",
              "collectedStatsExternalLogging": true,
              "externalLoggingPublisher": {
                "bigip": "/Common/default-ipsec-log-publisher"
              },
              "capturedTrafficInternalLogging": true,
              "notificationBySyslog": true,
              "publishIruleStatistics": true,
              "collectMaxTpsAndThroughput": true,
              "collectPageLoadTime": true,
              "collectClientSideStatistics": true,
              "collectUserSession": true,
              "collectUrl": true,
              "collectGeo": true,
              "collectIp": true,
              "collectSubnet": true,
              "collectUserAgent": true
            },
            "{{app_name}}": {
              "profileAnalytics": { "use": "{{app_name}}_analytics" }
            }
          {{/make_analytics_profile}}
          {{^make_analytics_profile}}
            "{{app_name}}": {
              "profileAnalytics": {
                "bigip": "{{analytics_existing_http_profile}}"
              }
            }
          {{/make_analytics_profile}}
        {{/enable_analytics}}
      }
    }
  }